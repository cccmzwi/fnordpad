#!/bin/bash

if [ -z $1 ]; then
    echo 1>&2 "Usage: $0 [soup url]"
    exit 127
fi

if [ -z $2 ]; then
		pages=5
else
		pages=$2
fi

url=$1

for ((i=0; i<pages; i++))
do

wget -qO - $url | grep -o 'http://[0-9a-z].asset.soup.io/asset/[^0000][^\"]*' | grep -wv square* | sed 's/_[0-9][0-9][0-9]\././' | sed 's/\.jpeg/.jpg/'

#Get the next page
since=`wget -qO - $url | grep -w 'SOUP.Endless.next_url' | grep -o "since[^\']*" | awk '{ sub(/\?mode\=own/, ""); print }'`

#Merge urls together
url=${1}${since}

done 

exit 0
